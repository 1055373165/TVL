# æ­å»ºä»¥å¤ªåŠç§é“¾



# ä¸‹è½½

1. ä¸‹è½½ geth é¡¹ç›®

> git clone [https://github.com/ethereum/go-ethereum.git](https://github.com/ethereum/go-ethereum.git)

1. ç¼–è¯‘ geth cli  å¯æ‰§è¡Œæ–‡ä»¶ ï¼ˆä½äº build/bin ç›®å½•ä¸‹ï¼‰

> make geth

1. å°†å¯æ‰§è¡Œæ–‡ä»¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­

> cp /build/bin/geth /usr/local/bin

1. æµ‹è¯•

> geth â€”help

# æ­å»ºç§æœ‰é“¾

1. é…ç½®åˆå§‹çŠ¶æ€

è¦è¿è¡Œä»¥å¤ªåŠç§æœ‰é“¾ï¼Œéœ€è¦å®šä¹‰è‡ªå·±çš„åˆ›ä¸–åŒºå—ï¼Œåˆ›ä¸–åŒºå—ä¿¡æ¯å†™åœ¨ä¸€ä¸ª JSON æ ¼å¼çš„é…ç½®æ–‡ä»¶ä¸­ã€‚é¦–å…ˆå°†ä¸‹é¢çš„å†…å®¹ä¿å­˜åˆ°ä¸€ä¸ª JSON æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚Â `genesis.json`

<aside>
ğŸ˜ˆ mkdir  workspace/privatechain


cd privatechain

mkdir data0

vi genesis.json

</aside>

```markdown
"config": {
        "chainId": 10, 
        "homesteadBlock": 0,
        "eip150Block": 0,
        "eip155Block": 0
    },
  "alloc"      : {},
  "coinbase"   : "0x0000000000000000000000000000000000000000",
  "difficulty" : "0x20000",
  "extraData"  : "",
  "gasLimit"   : "0x2fefd8",
  "nonce"      : "0x0000000000000042",
  "mixhash"    : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "parentHash" : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "timestamp"  : "0x00"
}
```

å…¶ä¸­ï¼ŒchainID æŒ‡å®šäº†ç‹¬ç«‹çš„åŒºå—é“¾ç½‘ç»œ IDã€‚ç½‘ç»œ ID åœ¨è¿æ¥åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œä»¥å¤ªåŠå…¬ç½‘çš„ç½‘ç»œ ID æ˜¯ 1ï¼Œä¸ºäº†ä¸ä¸å…¬æœ‰é“¾ç½‘ç»œå†²çªï¼Œè¿è¡Œç§æœ‰é“¾èŠ‚ç‚¹çš„æ—¶å€™è¦æŒ‡å®šè‡ªå·±çš„ç½‘ç»œ IDã€‚ä¸åŒ ID ç½‘ç»œçš„èŠ‚ç‚¹æ— æ³•ç›¸äº’è¿æ¥ã€‚é…ç½®æ–‡ä»¶è¿˜å¯¹å½“å‰æŒ–çŸ¿éš¾åº¦ difficultyã€åŒºå— Gas æ¶ˆè€—é™åˆ¶ gasLimit ç­‰å‚æ•°è¿›è¡Œäº†è®¾ç½®ã€‚

1. åˆå§‹åŒ–ï¼š å†™å…¥åˆ›ä¸–åŒºå—

å‡†å¤‡å¥½åˆ›ä¸–åŒºå—é…ç½®æ–‡ä»¶åï¼Œéœ€è¦`åˆå§‹åŒ–åŒºå—é“¾`ï¼Œå°†ä¸Šé¢çš„åˆ›ä¸–åŒºå—ä¿¡æ¯å†™å…¥åˆ°åŒºå—é“¾ä¸­ã€‚é¦–å…ˆè¦æ–°å»ºä¸€ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾åŒºå—é“¾æ•°æ®ï¼Œå‡è®¾æ–°å»ºçš„æ•°æ®ç›®å½•ä¸º ~/privatechain/data0ï¼Œgenesis.json ä¿å­˜åœ¨ ~/privatechain ä¸­ï¼Œæ­¤æ—¶ç›®å½•ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled.png)

æ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤

> geth init  â€”datadir data0  genesis.json

ä¸Šé¢çš„å‘½ä»¤çš„ä¸»ä½“æ˜¯Â `geth init`ï¼Œè¡¨ç¤ºåˆå§‹åŒ–åŒºå—é“¾ï¼Œå‘½ä»¤å¯ä»¥å¸¦æœ‰é€‰é¡¹å’Œå‚æ•°ï¼Œå…¶ä¸­Â `--datadir`Â é€‰é¡¹åé¢è·Ÿä¸€ä¸ªç›®å½•åï¼Œè¿™é‡Œä¸ºÂ `data0`ï¼Œè¡¨ç¤ºæŒ‡å®šæ•°æ®å­˜æ”¾ç›®å½•ä¸ºÂ `data0`ï¼Œ`genesis.json`Â æ˜¯Â `init`Â å‘½ä»¤çš„å‚æ•°ã€‚

è¿è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šè¯»å–Â `genesis.json`Â æ–‡ä»¶ï¼Œæ ¹æ®å…¶ä¸­çš„å†…å®¹ï¼Œå°†åˆ›ä¸–åŒºå—å†™å…¥åˆ°åŒºå—é“¾ä¸­ã€‚å¦‚æœçœ‹åˆ°ä»¥ä¸‹çš„è¾“å‡ºå†…å®¹ï¼Œè¯´æ˜åˆå§‹åŒ–æˆåŠŸäº†ã€‚

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%201.png)

åˆå§‹åŒ–æˆåŠŸåï¼Œä¼šåœ¨æ•°æ®ç›®å½• data0 ä¸­ç”Ÿæˆ `geth` å’Œ `keystore` ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæ­¤æ—¶ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%202.png)

å…¶ä¸­Â `geth/chaindata`Â ä¸­å­˜æ”¾çš„æ˜¯åŒºå—æ•°æ®ï¼Œ`keystore`Â ä¸­å­˜æ”¾çš„æ˜¯è´¦æˆ·æ•°æ®ã€‚

1. å¯åŠ¨ç§æœ‰é“¾èŠ‚ç‚¹

> geth console â€”networkid 110 â€”datadir data0

ä¸Šé¢å‘½ä»¤çš„ä¸»ä½“æ˜¯Â `geth console`ï¼Œè¡¨ç¤ºå¯åŠ¨èŠ‚ç‚¹å¹¶è¿›å…¥äº¤äº’å¼æ§åˆ¶å°ï¼Œ-â€“datadiré€‰é¡¹æŒ‡å®šä½¿ç”¨data0ä½œä¸ºæ•°æ®ç›®å½•ï¼Œ`--networkid`Â é€‰é¡¹åé¢è·Ÿä¸€ä¸ªæ•°å­—ï¼Œè¿™é‡Œæ˜¯`110`ï¼Œè¡¨ç¤ºæŒ‡å®šè¿™ä¸ªç§æœ‰é“¾çš„ç½‘ç»œidä¸º110ã€‚

ç½‘ç»œidåœ¨è¿æ¥åˆ°å…¶ä»–èŠ‚ç‚¹çš„æ—¶å€™ä¼šç”¨åˆ°ï¼Œä»¥å¤ªåŠå…¬ç½‘çš„ç½‘ç»œidæ˜¯1ï¼Œä¸ºäº†ä¸ä¸å…¬æœ‰é“¾ç½‘ç»œå†²çªï¼Œè¿è¡Œç§æœ‰é“¾èŠ‚ç‚¹çš„æ—¶å€™è¦æŒ‡å®šè‡ªå·±çš„ç½‘ç»œidã€‚

è¿è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œå°±å¯åŠ¨äº†åŒºå—é“¾èŠ‚ç‚¹å¹¶è¿›å…¥äº†è¯¥èŠ‚ç‚¹çš„æ§åˆ¶å°ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%203.png)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%204.png)

è¿™æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„ JavaScript æ‰§è¡Œç¯å¢ƒï¼Œåœ¨è¿™é‡Œé¢å¯ä»¥æ‰§è¡Œ JavaScript ä»£ç ï¼Œå…¶ä¸­ > æ˜¯å‘½ä»¤æç¤ºç¬¦ã€‚åœ¨è¿™ä¸ªç¯å¢ƒé‡Œä¹Ÿå†…ç½®äº†ä¸€äº›ç”¨æ¥æ“ä½œä»¥å¤ªåŠçš„ JavaScript å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›å¯¹è±¡ã€‚è¿™äº›å¯¹è±¡ä¸»è¦åŒ…æ‹¬ï¼š

- ethï¼šåŒ…å«ä¸€äº›è·Ÿæ“ä½œåŒºå—é“¾ç›¸å…³çš„æ–¹æ³•ï¼›
- netï¼šåŒ…å«ä¸€äº›æŸ¥çœ‹`p2pç½‘ç»œçŠ¶æ€`çš„æ–¹æ³•ï¼›
- adminï¼šåŒ…å«ä¸€äº›ä¸`ç®¡ç†èŠ‚ç‚¹`ç›¸å…³çš„æ–¹æ³•ï¼›
- minerï¼šåŒ…å«å¯åŠ¨&åœæ­¢æŒ–çŸ¿çš„ä¸€äº›æ–¹æ³•ï¼›
- personalï¼šä¸»è¦åŒ…å«ä¸€äº›ç®¡ç†è´¦æˆ·çš„æ–¹æ³•ï¼›
- txpoolï¼šåŒ…å«ä¸€äº›æŸ¥çœ‹äº¤æ˜“å†…å­˜æ± çš„æ–¹æ³•ï¼›
- web3ï¼šåŒ…å«äº†ä»¥ä¸Šå¯¹è±¡ï¼Œè¿˜åŒ…å«ä¸€äº›å•ä½æ¢ç®—çš„æ–¹æ³•ã€‚

# æ§åˆ¶å°æ“ä½œ

è¿›å…¥ä»¥å¤ªåŠ Javascript Console åï¼Œå°±å¯ä»¥ä½¿ç”¨é‡Œé¢çš„å†…ç½®å¯¹è±¡åšä¸€äº›æ“ä½œï¼Œè¿™äº›å†…ç½®å¯¹è±¡æä¾›çš„åŠŸèƒ½å¾ˆä¸°å¯Œï¼Œæ¯”å¦‚æŸ¥çœ‹åŒºå—å’Œäº¤æ˜“ã€åˆ›å»ºè´¦æˆ·ã€æŒ–çŸ¿ã€å‘é€äº¤æ˜“ã€éƒ¨ç½²æ™ºèƒ½åˆçº¦ç­‰ã€‚

å¸¸ç”¨å‘½ä»¤æœ‰ï¼š

- personal.newAccount()ï¼šåˆ›å»ºè´¦æˆ·ï¼›
- personal.unlockAccount()ï¼šè§£é”è´¦æˆ·ï¼›
- eth.accountsï¼š`æšä¸¾`ç³»ç»Ÿä¸­çš„è´¦æˆ·ï¼›
- eth.getBalance()ï¼šæŸ¥çœ‹è´¦æˆ·ä½™é¢ï¼Œè¿”å›å€¼çš„å•ä½æ˜¯ `Wei`ï¼ˆWei æ˜¯ä»¥å¤ªåŠä¸­æœ€å°è´§å¸é¢é¢å•ä½ï¼Œç±»ä¼¼æ¯”ç‰¹å¸ä¸­çš„èªï¼Œ1 ether = 10^18 Weiï¼‰ï¼›
- eth.blockNumberï¼šåˆ—å‡ºåŒºå—æ€»æ•°ï¼›
- eth.getTransaction()ï¼šè·å–äº¤æ˜“ï¼›
- eth.getBlock()ï¼šè·å–åŒºå—ï¼›
- miner.`start()`ï¼šå¼€å§‹æŒ–çŸ¿ï¼›
- miner.stop()ï¼šåœæ­¢æŒ–çŸ¿ï¼›
- eth.coinbaseï¼šæŒ–çŸ¿å¥–åŠ±çš„è´¦æˆ·
- web3.fromWei()ï¼šWei æ¢ç®—æˆä»¥å¤ªå¸ï¼›
- web3.toWei()ï¼šä»¥å¤ªå¸æ¢ç®—æˆ Weiï¼›
- txpool.statusï¼šäº¤æ˜“æ± ä¸­çš„çŠ¶æ€ï¼›
- admin.addPeer()ï¼šè¿æ¥åˆ°å…¶ä»–èŠ‚ç‚¹ï¼›

1. åˆ›å»ºè´¦æˆ·

è¾“å…¥ `eth.accounts` æŸ¥è¯¢ç³»ç»Ÿä¸­çš„è´¦æˆ·ï¼š

> eth.accounts

æ˜¾ç¤ºä¸ºÂ `[]`ï¼Œè¡¨ç¤ºæ²¡æœ‰è´¦æˆ·ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨Â `personal.newAccount()`Â æ¥åˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼š

> personal.newAccount()

è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œå¾—åˆ° `0x593abc88dfd6c6078f3739e7d6a3420d5b3609dd`

å†æ¬¡åˆ›å»ºä¸€ä¸ªè´¦æˆ·

`0xfe1aba3e41de132145767943f4e046d004b4a12e`

è´¦æˆ·é»˜è®¤ä¼šä¿å­˜åœ¨æ•°æ®ç›®å½•çš„Â `data0/keystore`Â æ–‡ä»¶å¤¹ä¸­ã€‚å¯ä»¥æŸ¥çœ‹å…¶ä¸­çš„æ–‡ä»¶

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%205.png)

1. ****æŸ¥çœ‹è´¦æˆ·ä½™é¢****

> eth.getBalance(â€addressâ€)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%206.png)

ç›®å‰ä¸¤ä¸ªè´¦æˆ·çš„ä»¥å¤ªå¸ä½™é¢éƒ½æ˜¯0ï¼Œè¦ä½¿è´¦æˆ·æœ‰ä½™é¢ï¼Œå¯ä»¥ä»å…¶ä»–è´¦æˆ·è½¬è´¦è¿‡æ¥ï¼Œæˆ–è€…é€šè¿‡æŒ–çŸ¿æ¥è·å¾—ä»¥å¤ªå¸å¥–åŠ±ã€‚

1. ****å¯åŠ¨&åœæ­¢æŒ–çŸ¿****

é€šè¿‡Â `miner.start()`Â å¯åŠ¨æŒ–çŸ¿

> miner.start()

å…¶ä¸­ start çš„å‚æ•°è¡¨ç¤ºæŒ–çŸ¿ä½¿ç”¨çš„`çº¿ç¨‹æ•°`ã€‚ç¬¬ä¸€æ¬¡å¯åŠ¨æŒ–çŸ¿ä¼šå…ˆç”ŸæˆæŒ–çŸ¿æ‰€éœ€çš„ DAG æ–‡ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹æ…¢ï¼Œç­‰è¿›åº¦è¾¾åˆ° 100% åï¼Œå°±ä¼šå¼€å§‹æŒ–çŸ¿ï¼Œæ­¤æ—¶å±å¹•ä¼šè¢«æŒ–çŸ¿ä¿¡æ¯åˆ·å±ã€‚

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%207.png)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%208.png)

åœæ­¢æŒ–çŸ¿ï¼Œåœ¨ console ä¸­è¾“å…¥ï¼š

> miner.stop()

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%209.png)

æŒ–åˆ°ä¸€ä¸ªåŒºå—ä¼šå¥–åŠ±5ä¸ªä»¥å¤ªå¸ï¼ŒæŒ–çŸ¿æ‰€å¾—çš„å¥–åŠ±ä¼šè¿›å…¥çŸ¿å·¥çš„è´¦æˆ·ï¼Œè¿™ä¸ªè´¦æˆ·å«åšcoinbaseï¼Œé»˜è®¤æƒ…å†µä¸‹coinbaseæ˜¯æœ¬åœ°è´¦æˆ·ä¸­çš„ç¬¬ä¸€ä¸ªè´¦æˆ·ï¼š

> eth.coinbase

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2010.png)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2011.png)

å¯ä»¥é€šè¿‡Â `miner.setEtherbase()`Â å°†å…¶ä»–è´¦æˆ·è®¾ç½®æˆÂ `coinbase`Â å³å¯

> miner.setEtherbase(â€`0xfe1aba3e41de132145767943f4e046d004b4a12e`â€)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2012.png)

é‡æ–°å¯åŠ¨æŒ–çŸ¿ï¼ŒæŸ¥çœ‹Â `eth.accounts[1]`Â æ˜¯å¦å¯ä»¥è·å¾—ä»¥å¤ªå¸

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2013.png)

æŸ¥è¯¢è´¦æˆ·ä½™é¢ï¼š

> eth.getBalance(eth.accounts[0])
> eth.getBalance(eth.accounts[1])

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2014.png)

`getBalance()`Â è¿”å›å€¼çš„å•ä½æ˜¯weiï¼Œweiæ˜¯ä»¥å¤ªå¸çš„æœ€å°å•ä½ï¼Œ1ä¸ªä»¥å¤ªå¸=10çš„18æ¬¡æ–¹ä¸ªweiã€‚è¦æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªä»¥å¤ªå¸ï¼Œå¯ä»¥ç”¨web3.fromWei()å°†è¿”å›å€¼æ¢ç®—æˆä»¥å¤ªå¸ï¼š

> web3.fromWei(eth.getBalance(eth.accounts[0]))
> web3.fromWei(eth.getBalance(eth.accounts[1]))

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2015.png)

****4 å‘é€äº¤æ˜“****

ä»è´¦æˆ·0è½¬ç§»10ä¸ªä»¥å¤ªå¸åˆ°è´¦æˆ·1,é¦–å…ˆè¦è§£é”è´¦æˆ· 0ï¼Œæ‰èƒ½å‘èµ·äº¤æ˜“ï¼š

> personal.unlockAccount(eth.accounts[0])

è¾“å…¥å¯†ç è§£é”è´¦æˆ·

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2016.png)

å…ˆå°† 10 ETH è½¬æ¢ä¸º wei å•ä½ å¹¶èµ‹ç»™å˜é‡ amount

> amount = web3.toWei(10, â€˜etherâ€™)
> eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2017.png)

æŸ¥è¯¢ è´¦æˆ·1 çš„ä½™é¢ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2018.png)

å‘ç°è´¦æˆ·ä½™é¢æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ­¤æ—¶äº¤æ˜“å·²ç»æäº¤åˆ°åŒºå—é“¾ï¼Œä½†è¿˜æœªè¢«å¤„ç†ï¼Œè¿™å¯ä»¥é€šè¿‡ç”¨Â `txpool.status`Â å‘½ä»¤å¯ä»¥çœ‹åˆ°æœ¬åœ°äº¤æ˜“æ± ä¸­æœ‰ä¸€ä¸ªå¾…ç¡®è®¤çš„äº¤æ˜“ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2019.png)

å…¶ä¸­æœ‰ä¸€æ¡pendingçš„äº¤æ˜“ï¼Œpendingè¡¨ç¤ºå·²æäº¤ä½†è¿˜æœªè¢«å¤„ç†çš„äº¤æ˜“ã€‚

è¦ä½¿äº¤æ˜“è¢«å¤„ç†ï¼Œå¿…é¡»è¦æŒ–çŸ¿ã€‚è¿™é‡Œæˆ‘ä»¬å¯åŠ¨æŒ–çŸ¿ï¼Œç„¶åç­‰å¾…æŒ–åˆ°ä¸€ä¸ªåŒºå—ä¹‹åå°±åœæ­¢æŒ–çŸ¿ï¼š

> miner.start(1);admin.sleepBlocks(1);miner.stop()

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2020.png)

> web3.fromWei(eth.getBalance(eth.accounts[0]))
> web3.fromWei(eth.getBalance(eth.accounts[1]))

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2021.png)

å‘ç°è´¦æˆ·æ”¶åˆ°äº†è´¦æˆ·çš„é’±ï¼Œè¿˜å¤šäº†5ä¸ªä»¥å¤ªå¸ã€‚å…¶å®å¤šå‡ºçš„5ä¸ªä»¥å¤ªå¸æ˜¯æŒ–çŸ¿å¥–åŠ±ã€‚

****5 æŸ¥çœ‹äº¤æ˜“å’ŒåŒºå—****

æŸ¥çœ‹å½“å‰åŒºå—æ€»æ•°ï¼š

> eth.blockNumber

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2022.png)

é€šè¿‡åŒºå—å·æŸ¥çœ‹åŒºå—ï¼š

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2023.png)

é€šè¿‡äº¤æ˜“hashï¼ˆhash å€¼åŒ…å«åœ¨ä¸Šé¢äº¤æ˜“è¿”å›å€¼ä¸­ï¼‰æŸ¥çœ‹äº¤æ˜“ï¼š

> eth.getTransaction(â€0x5e2f33b639920de139d01f8facc2fb13d34bfc9cda6c560b21abbfe5219845edâ€)
> eth.getTransaction(â€hashâ€)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2024.png)

![Untitled](https://cdn.jsdelivr.net/gh/1055373165/image@main/Untitled%2025.png)